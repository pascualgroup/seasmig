
import java.io.BufferedReader;
import java.io.DataInputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.HashMap;
import java.util.List;

import jebl.evolution.graphs.Node;
import jebl.evolution.io.ImportException;
import jebl.evolution.io.NexusImporter;
import jebl.evolution.io.TreeImporter;
import jebl.evolution.trees.SimpleRootedTree;

class SeasonalMigration {
	public static void main(String[] args) throws IOException, ImportException {


		// Test Migration Matrices
		double[][] Q1 = {{-0.75,0.25,0.25,0.25},{0.25,-0.75,0.25,0.25},{0.25,0.25,-0.75,0.25},{0.25,0.25,0.25,-0.75}};				
		double[][] Q2 = {{-0.85,0.35,0.25,0.25},{0.25,-0.55,0.05,0.25},{0.15,0.15,-0.55,0.25},{0.25,0.25,0.25,-0.75}};
		double[][] Q3 = {{-0.412357, 0.0180749, 0.0460806, 0.0293675, 0.00627788, 0.030991, 
			0.0376639, 0.0445947, 0.0101763, 0.0108151, 0.00535896, 0.00358473, 
			0.0334564, 0.00914292, 0.00669163, 0.0303812, 0.0125379, 0.0316359, 
			0.0423302, 0.00319533}, {0.0519589, -0.712452, 0.0664767, 0.0218117,
				0.0440965, 0.0737369, 0.0558381, 0.00813473, 0.0146685, 0.0294384, 
				0.0355782, 0.0639107, 0.0376599, 0.0286312, 0.0360789, 0.0439897, 
				0.00304944, 0.021843, 0.0150794, 0.0604711}, {0.0494072, 
					0.0347208, -0.502177, 0.0250123, 0.0388597, 0.013749, 0.00375436, 
					0.0383871, 0.0156076, 0.0315721, 0.0477005, 0.000543748, 0.0521019, 
					0.026135, 0.0311297, 0.00685823, 0.0451634, 0.00185773, 0.0302422, 
					0.00937494}, {0.00422004, 0.00679, 0.00606555, -0.110355, 
						0.00136531, 0.000827895, 0.00192284, 0.00484157, 0.00335668, 
						0.0090513, 0.00930614, 0.00308227, 0.00826574, 0.00801859, 
						0.0107383, 0.00142048, 0.0101143, 0.00184912, 0.0096254, 
						0.00949345}, {0.00352857, 0.00954776, 0.00826824, 
							0.00321751, -0.114215, 0.00168709, 0.0112009, 0.00951294, 
							0.00292861, 0.00340316, 0.00750914, 0.00656667, 0.00240384, 
							0.00512505, 0.0014562, 0.0025511, 0.00794236, 0.0108922, 0.00728306,
							0.00919089}, {0.0315814, 0.0434899, 0.0285152, 0.0232444, 
								0.0210669, -0.583113, 0.0131852, 0.0333724, 0.0446165, 0.00474247, 
								0.0151219, 0.0057539, 0.0611438, 0.013687, 0.0595761, 0.0647915, 
								0.0145605, 0.0609616, 0.0433109, 0.000390868}, {0.0587533, 
									0.0163595, 0.020254, 0.0485052, 0.0863528, 0.0407673, -0.999161, 
									0.0573667, 0.0730241, 0.0713332, 0.0229602, 0.0128919, 0.0611515, 
									0.0664346, 0.0704298, 0.0418041, 0.0573631, 0.0885014, 0.0453032, 
									0.0596051}, {0.0531481, 0.0131295, 0.0489223, 0.0262615, 0.0189365, 
										0.0412226, 0.0109903, -0.505924, 0.0335647, 0.0184592, 0.0511501, 
										0.00609614, 0.0225688, 0.0453697, 0.0111924, 0.00584083, 0.0301008, 
										0.00973252, 0.0343014, 0.0249363}, {0.0283085, 0.0128365, 0.0248569,
											0.0271116, 0.00266883, 0.0127893, 0.0147236, 0.0264807, -0.28557, 
											0.00210254, 0.0295773, 0.0131295, 0.00210299, 0.000194656, 
											0.0131343, 0.00160135, 0.0208405, 0.0210997, 0.0200749, 
											0.0119368}, {0.00160508, 0.0776108, 0.0869913, 0.0448622, 0.0882993,
												0.0612116, 0.0355186, 0.00900947, 0.0441475, -0.901018, 0.0052486, 
												0.0307856, 0.0764118, 0.0657938, 0.103276, 0.0487251, 0.00963311, 
												0.00680745, 0.0446419, 0.0604387}, {0.0224508, 0.0329729, 0.0240785,
													0.0485623, 0.00330923, 0.0292943, 0.0326987, 0.0363974, 0.0143924, 
													0.0545798, -0.624129, 0.00828883, 0.0050246, 0.0511562, 0.0581181, 
													0.00406971, 0.049453, 0.0493549, 0.0526035, 0.0473237}, {0.0171527, 
														0.00654263, 0.0171207, 0.00402336, 0.0036728, 0.014504, 0.0122431, 
														0.00518008, 0.0100098, 0.00912067, 0.0167637, -0.172264, 0.0062057, 
														0.0158558, 0.0104947, 0.00995825, 0.00437581, 0.0025439, 0.00462284,
														0.00187369}, {0.0352248, 0.0430875, 0.00731149, 0.0306361, 
															0.0323144, 0.0577322, 0.0466594, 0.00780022, 0.0202168, 0.0439553, 
															0.0424743, 0.0513081, -0.563109, 0.0286015, 0.00260657, 0.0197324, 
															0.00780768, 0.0533454, 0.0305521, 0.00174252}, {0.00366646, 
																0.00228446, 0.00211606, 0.0000684778, 0.000396708, 0.00184665, 
																0.000513819, 0.00302415, 0.00144779, 0.000939199, 0.00147616, 
																0.00188436, 0.00289561, -0.0360662, 0.00392485, 0.0038425, 
																0.000347565, 0.00291502, 0.00230326, 0.000173065}, {0.00131571, 
																	0.0271972, 0.0153065, 0.0151384, 0.0130121, 0.0267731, 0.0266706, 
																	0.00736637, 0.00361667, 0.00269658, 0.0244947, 0.0150001, 0.0149904,
																	0.0210822, -0.26574, 0.0143338, 0.0161333, 0.0137047, 0.00687484, 
																	0.0000330621}, {0.0120772, 0.0123502, 0.0291295, 0.00244173, 
																		0.00290835, 0.0251275, 0.015396, 0.00858508, 0.0105209, 0.0158237, 
																		0.0127178, 0.0170447, 0.0211168, 0.00915082, 0.0125822, -0.286761, 
																		0.00137954, 0.028605, 0.0242248, 0.0255795}, {0.000543522, 
																			0.0181644, 0.0176883, 0.00159667, 0.0164246, 0.0190123, 0.00691034, 
																			0.00859706, 0.0213834, 0.0160425, 0.0136554, 0.00150142, 0.00396448,
																			0.0144281, 0.0196321, 0.00173254, -0.208971, 0.00939781, 0.0111814,
																			0.00711437}, {0.0101817, 0.0255421, 0.0298854, 0.0278077, 
																				0.0261052, 0.0156127, 0.0308863, 0.0398438, 0.0260896, 0.0314074, 
																				0.0117333, 0.00662656, 0.0136948, 0.00285876, 0.0186344, 0.0170915, 
																				0.000716974, -0.386036, 0.0401554, 0.0111627}, {0.0129891, 
																					0.00629531, 0.0159187, 0.00851662, 0.0286212, 0.00328148, 0.0300163,
																					0.00777507, 0.00778917, 0.00829124, 0.0166668, 0.0124671, 
																					0.0218806, 0.0301149, 0.0204226, 0.00978438, 0.0201486, 
																					0.0300542, -0.315194, 0.0241611}, {0.0461732, 0.0391849, 0.0653606, 
																						0.0844675, 0.0031699, 0.0225576, 0.0590115, 0.00680368, 0.0427315, 
																						0.0600923, 0.0377949, 0.0514076, 0.0516682, 0.0729424, 0.00513081, 
																						0.00612455, 0.0645898, 0.0377022, 0.00160603, -0.758519}};
		double[][] Q4 = {{-0.15302, 0.00378702, 0.0144431, 0.00756213, 0.00856889, 
			0.000872814, 0.00587519, 0.0030577, 0.00775118, 0.00458198, 
			0.011611, 0.0146258, 0.00296314, 0.00881777, 0.0151298, 0.0123795, 
			0.00532741, 0.00845068, 0.00370495, 
			0.0135104}, {0.027779, -0.352881, 0.00423888, 0.0317548, 0.0216791, 
				0.0220506, 0.00477107, 0.0345763, 0.00772243, 0.0341221, 0.00928001,
				0.0123775, 0.0368846, 0.025066, 0.0018294, 0.00647094, 0.0132263, 
				0.0102407, 0.0306994, 0.0181117}, {0.025406, 0.0658283, -0.730455, 
					0.00354293, 0.0719531, 0.00835751, 0.0564443, 0.0427285, 0.0339872, 
					0.0370337, 0.0174936, 0.0344265, 0.0758675, 0.0165314, 0.0491267, 
					0.0782509, 0.0251442, 0.0376519, 0.04601, 0.00467084}, {0.0423437, 
						0.0368629, 0.00414611, -0.592693, 0.0535111, 0.0242255, 0.0427017, 
						0.021972, 0.0100674, 0.0206089, 0.0527023, 0.0117411, 0.0128636, 
						0.0378322, 0.0383907, 0.0140618, 0.0507243, 0.0201393, 0.054126, 
						0.0436719}, {0.0255894, 0.0105415, 0.00759389, 
							0.00496203, -0.331764, 0.0186768, 0.00679092, 0.0233658, 0.0230203, 
							0.00285629, 0.0226501, 0.0141339, 0.0378101, 0.0263327, 0.00373251, 
							0.0132269, 0.0148895, 0.0159693, 0.0341249, 0.0254971}, {0.0704852, 
								0.039802, 0.0719356, 0.060777, 0.0641662, -0.861045, 0.0251541, 
								0.0633436, 0.0256346, 0.0651769, 0.0226513, 0.0915036, 0.061011, 
								0.00347301, 0.0185084, 0.0508067, 0.00356258, 0.00384666, 0.0816255,
								0.0375812}, {0.0326114, 0.0741136, 0.0110285, 0.035949, 0.00997892,
									0.0654894, -0.834174, 0.0467748, 0.0746933, 0.0283683, 0.0577241, 
									0.00658178, 0.0801738, 0.0205439, 0.0783844, 0.02026, 0.0410374, 
									0.0706861, 0.0569447, 0.0228302}, {0.00939326, 0.0389392, 0.0409979,
										0.00835341, 0.0349601, 0.0416272, 0.012755, -0.548217, 0.0153495, 
										0.027934, 0.0105508, 0.00863019, 0.0532182, 0.0352884, 0.0493368, 
										0.0172753, 0.0308255, 0.049228, 0.0509432, 0.012611}, {0.000353822, 
											0.03334, 0.0255934, 0.0409331, 0.0313324, 0.0254115, 0.0415587, 
											0.0202563, -0.438179, 0.0110859, 0.0229304, 0.0235194, 0.029134, 
											0.0331435, 0.00176953, 0.00233847, 0.0335413, 0.00988801, 0.0368397,
											0.0152101}, {0.0365816, 0.0578971, 0.00201929, 0.0504936, 
												0.0073576, 0.0586886, 0.022592, 0.00015188, 0.0140029, -0.559832, 
												0.0257475, 0.0281102, 0.0342887, 0.0261902, 0.0202716, 0.0563335, 
												0.0174249, 0.0224149, 0.0191654, 0.0601004}, {0.0335482, 0.0145519, 
													0.0177978, 0.0594658, 0.0287606, 0.0532348, 0.00974885, 0.0215462, 
													0.0629629, 0.0653408, -0.731912, 0.0394867, 0.0365792, 0.0608153, 
													0.0200602, 0.0311347, 0.0614634, 0.00618926, 0.038369, 
													0.0708562}, {0.0165744, 0.0543665, 0.0269225, 0.073023, 0.038215, 
														0.0467984, 0.0578761, 0.0024373, 0.0463724, 0.0192988, 
														0.07346, -0.772933, 0.0501245, 0.0722131, 0.00316467, 0.0618922, 
														0.0535794, 0.00468413, 0.00680779, 0.0651227}, {0.0667376, 
															0.0389973, 0.0624848, 0.0246681, 0.0241987, 0.0485647, 0.0527305, 
															0.0069364, 0.041921, 0.0608689, 0.0182749, 0.0518059, -0.716696, 
															0.00140846, 0.0620437, 0.0666889, 0.00435763, 0.0452533, 0.0224325, 
															0.0163228}, {0.0707681, 0.0106822, 0.0292395, 0.032584, 0.0435709, 
																0.0473827, 0.0507052, 0.0360067, 0.0395895, 0.0384695, 0.0244609, 
																0.0825835, 0.0539262, -0.852414, 0.0732251, 0.029356, 0.0118845, 
																0.074982, 0.0665052, 0.0364924}, {0.0834875, 0.0703586, 0.0377051, 
																	0.0170678, 0.0571688, 0.0131515, 0.0098664, 0.0648758, 0.0380171, 
																	0.0626842, 0.0264211, 0.00810421, 0.0688744, 0.0263766, -0.85028, 
																	0.0941913, 0.00988785, 0.0272402, 0.0379576, 0.0968438}, {0.0283567,
																		0.000056815, 0.0521388, 0.0201759, 0.0324888, 0.0219936, 0.0143342,
																		0.0466839, 0.0502224, 0.00290097, 0.00391369, 0.036723, 0.0539412, 
																		0.0433658, 0.0339632, -0.603498, 0.0209626, 0.0322056, 0.0497584, 
																		0.059312}, {0.0316104, 0.0249166, 0.0119129, 0.0305731, 0.0291288, 
																			0.0403175, 0.0229754, 0.00584172, 0.0389852, 0.00320878, 0.017218, 
																			0.00395994, 0.0333355, 0.0128013, 0.0124427, 0.0223825, -0.413935, 
																			0.0145483, 0.0330998, 0.0246768}, {0.0184479, 0.0027693, 0.0349155, 
																				0.011359, 0.0339936, 0.0125828, 0.0313301, 0.041374, 0.00384728, 
																				0.0237285, 0.00931024, 0.0413441, 0.034078, 0.0151945, 0.0269338, 
																				0.0356426, 0.0284213, -0.416016, 0.00406037, 
																				0.00668322}, {0.0589916, 0.00673221, 0.0327265, 0.0331193, 0.050499,
																					0.0395918, 0.0176671, 0.0515461, 0.0518997, 0.0285715, 0.0342272, 
																					0.0180254, 0.00732076, 0.0456731, 0.00496638, 0.0407468, 0.00148634,
																					0.0228421, -0.560425, 0.0137923}, {0.0450543, 0.0851575, 0.0429045,
																						0.00460384, 0.00085075, 0.0487822, 0.0180871, 0.0156848, 
																						0.00817484, 0.0508376, 0.0423829, 0.0499873, 0.0490193, 0.0834692, 
																						0.0290208, 0.0928248, 0.0203477, 0.0887567, 0.0789808, -0.854927}};

		double[][] Q4dist = {{-0.16302, 0.01378702, 0.0144431, 0.00756213, 0.00856889, 
			0.000872814, 0.00587519, 0.0030577, 0.00775118, 0.00458198, 
			0.011611, 0.0146258, 0.00296314, 0.00881777, 0.0151298, 0.0123795, 
			0.00532741, 0.00845068, 0.00370495, 
			0.0135104}, {0.037779, -0.362881, 0.00423888, 0.0317548, 0.0216791, 
				0.0220506, 0.00477107, 0.0345763, 0.00772243, 0.0341221, 0.00928001,
				0.0123775, 0.0368846, 0.025066, 0.0018294, 0.00647094, 0.0132263, 
				0.0102407, 0.0306994, 0.0181117}, {0.025406, 0.0658283, -0.730455, 
					0.00354293, 0.0719531, 0.00835751, 0.0564443, 0.0427285, 0.0339872, 
					0.0370337, 0.0174936, 0.0344265, 0.0758675, 0.0165314, 0.0491267, 
					0.0782509, 0.0251442, 0.0376519, 0.04601, 0.00467084}, {0.0423437, 
						0.0368629, 0.00414611, -0.592693, 0.0535111, 0.0242255, 0.0427017, 
						0.021972, 0.0100674, 0.0206089, 0.0527023, 0.0117411, 0.0128636, 
						0.0378322, 0.0383907, 0.0140618, 0.0507243, 0.0201393, 0.054126, 
						0.0436719}, {0.0255894, 0.0105415, 0.00759389, 
							0.00496203, -0.331764, 0.0186768, 0.00679092, 0.0233658, 0.0230203, 
							0.00285629, 0.0226501, 0.0141339, 0.0378101, 0.0263327, 0.00373251, 
							0.0132269, 0.0148895, 0.0159693, 0.0341249, 0.0254971}, {0.0704852, 
								0.039802, 0.0719356, 0.060777, 0.0641662, -0.861045, 0.0251541, 
								0.0633436, 0.0256346, 0.0651769, 0.0226513, 0.0915036, 0.061011, 
								0.00347301, 0.0185084, 0.0508067, 0.00356258, 0.00384666, 0.0816255,
								0.0375812}, {0.0326114, 0.0741136, 0.0110285, 0.035949, 0.00997892,
									0.0654894, -0.834174, 0.0467748, 0.0746933, 0.0283683, 0.0577241, 
									0.00658178, 0.0801738, 0.0205439, 0.0783844, 0.02026, 0.0410374, 
									0.0706861, 0.0569447, 0.0228302}, {0.00939326, 0.0389392, 0.0409979,
										0.00835341, 0.0349601, 0.0416272, 0.012755, -0.548217, 0.0153495, 
										0.027934, 0.0105508, 0.00863019, 0.0532182, 0.0352884, 0.0493368, 
										0.0172753, 0.0308255, 0.049228, 0.0509432, 0.012611}, {0.000353822, 
											0.03334, 0.0255934, 0.0409331, 0.0313324, 0.0254115, 0.0415587, 
											0.0202563, -0.438179, 0.0110859, 0.0229304, 0.0235194, 0.029134, 
											0.0331435, 0.00176953, 0.00233847, 0.0335413, 0.00988801, 0.0368397,
											0.0152101}, {0.0365816, 0.0578971, 0.00201929, 0.0504936, 
												0.0073576, 0.0586886, 0.022592, 0.00015188, 0.0140029, -0.559832, 
												0.0257475, 0.0281102, 0.0342887, 0.0261902, 0.0202716, 0.0563335, 
												0.0174249, 0.0224149, 0.0191654, 0.0601004}, {0.0335482, 0.0145519, 
													0.0177978, 0.0594658, 0.0287606, 0.0532348, 0.00974885, 0.0215462, 
													0.0629629, 0.0653408, -0.731912, 0.0394867, 0.0365792, 0.0608153, 
													0.0200602, 0.0311347, 0.0614634, 0.00618926, 0.038369, 
													0.0708562}, {0.0165744, 0.0543665, 0.0269225, 0.073023, 0.038215, 
														0.0467984, 0.0578761, 0.0024373, 0.0463724, 0.0192988, 
														0.07346, -0.772933, 0.0501245, 0.0722131, 0.00316467, 0.0618922, 
														0.0535794, 0.00468413, 0.00680779, 0.0651227}, {0.0667376, 
															0.0389973, 0.0624848, 0.0246681, 0.0241987, 0.0485647, 0.0527305, 
															0.0069364, 0.041921, 0.0608689, 0.0182749, 0.0518059, -0.716696, 
															0.00140846, 0.0620437, 0.0666889, 0.00435763, 0.0452533, 0.0224325, 
															0.0163228}, {0.0707681, 0.0106822, 0.0292395, 0.032584, 0.0435709, 
																0.0473827, 0.0507052, 0.0360067, 0.0395895, 0.0384695, 0.0244609, 
																0.0825835, 0.0539262, -0.852414, 0.0732251, 0.029356, 0.0118845, 
																0.074982, 0.0665052, 0.0364924}, {0.0834875, 0.0703586, 0.0377051, 
																	0.0170678, 0.0571688, 0.0131515, 0.0098664, 0.0648758, 0.0380171, 
																	0.0626842, 0.0264211, 0.00810421, 0.0688744, 0.0263766, -0.85028, 
																	0.0941913, 0.00988785, 0.0272402, 0.0379576, 0.0968438}, {0.0283567,
																		0.000056815, 0.0521388, 0.0201759, 0.0324888, 0.0219936, 0.0143342,
																		0.0466839, 0.0502224, 0.00290097, 0.00391369, 0.036723, 0.0539412, 
																		0.0433658, 0.0339632, -0.603498, 0.0209626, 0.0322056, 0.0497584, 
																		0.059312}, {0.0316104, 0.0249166, 0.0119129, 0.0305731, 0.0291288, 
																			0.0403175, 0.0229754, 0.00584172, 0.0389852, 0.00320878, 0.017218, 
																			0.00395994, 0.0333355, 0.0128013, 0.0124427, 0.0223825, -0.413935, 
																			0.0145483, 0.0330998, 0.0246768}, {0.0184479, 0.0027693, 0.0349155, 
																				0.011359, 0.0339936, 0.0125828, 0.0313301, 0.041374, 0.00384728, 
																				0.0237285, 0.00931024, 0.0413441, 0.034078, 0.0151945, 0.0269338, 
																				0.0356426, 0.0284213, -0.416016, 0.00406037, 
																				0.00668322}, {0.0589916, 0.00673221, 0.0327265, 0.0331193, 0.050499,
																					0.0395918, 0.0176671, 0.0515461, 0.0518997, 0.0285715, 0.0342272, 
																					0.0180254, 0.00732076, 0.0456731, 0.00496638, 0.0407468, 0.00148634,
																					0.0228421, -0.560425, 0.0137923}, {0.0450543, 0.0851575, 0.0429045,
																						0.00460384, 0.00085075, 0.0487822, 0.0180871, 0.0156848, 
																						0.00817484, 0.0508376, 0.0423829, 0.0499873, 0.0490193, 0.0834692, 
																						0.0290208, 0.0928248, 0.0203477, 0.0887567, 0.0789808, -0.854927}};

		double[][] QC1 = new double[][]  
				// re  im re im ...	
				{{-0.75,0.0,	0.25,0.0,		0.25,0.0,	0.25,0.0},
				{0.25,0.0,		-0.75,0.0,		0.25,0.0,	0.25,0.0},
				{0.25,0.0,		0.25,0.0,		-0.75,0.0,	0.25,0.0},
				{0.25,0.0,		0.25,0.0,		0.25,0.0,	-0.75,0.0}};

		double[][] QC2 = new double[][]  
				// re  im re im ...	
				{{-0.75,1.0,	0.25,-0.5,		0.25,-0.5,	0.25,0.0},
				{0.25,0.0,		-0.75,-0.5,		0.25,0.25,	0.25,0.25},
				{0.25,0.0,		0.25,0.0,		-0.75,0.0,	0.25,0.0},
				{0.25,0.0,		0.25,-1.0,		0.25,-1.0,	-0.75,2.0}};

		double[][] Q14 = {{-0.8, 0., 0.1, 0., 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0., 0., 0.1, 
			0.}, {0., -0.2, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 
				0.}, {0., 0.1, -0.6, 0.1, 0., 0.1, 0., 0., 0., 0.1, 0., 0., 0., 
					0.}, {0.1, 0., 0.1, -0.7, 0.1, 0.1, 0., 0., 0.1, 0., 0., 0., 0.1, 
						0.1}, {0., 0., 0., 0., -0.4, 0., 0., 0., 0.1, 0.1, 0., 0., 0., 
							0.}, {0.1, 0., 0.1, 0., 0.1, -0.7, 0., 0.1, 0., 0.1, 0.1, 0.1, 0.1, 
								0.}, {0.1, 0., 0., 0.1, 0., 0., -0.8, 0.1, 0., 0., 0.1, 0.1, 0.1, 
									0.1}, {0., 0.1, 0., 0., 0.1, 0., 0.1, -0.6, 0.1, 0.1, 0., 0., 0., 
										0.1}, {0.1, 0., 0.1, 0.1, 0.1, 0.1, 0., 0.1, -0.7, 0., 0., 0., 0., 
											0.}, {0., 0., 0., 0.1, 0., 0.1, 0., 0., 0.1, -0.4, 0., 0., 0., 
												0.1}, {0.1, 0.1, 0.1, 0.1, 0.1, 0., 0., 0., 0., 0.1, -0.6, 0.1, 0.1,
													0.}, {0., 0., 0.1, 0., 0., 0., 0., 0.1, 0., 0.1, 0., -0.4, 0., 
														0.1}, {0., 0., 0.1, 0., 0., 0., 0., 0., 0., 0., 0., 0., -0.4, 
															0.}, {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -0.2}};


		double[][] Q3S = {{-0.5, 0.2, 0.3}, {0.1, -0.9, 0.8}, {0.3, 0.2, -0.5}};
		
		//MigrationModel createTreeModel = new TwoSeasonalRateBasedMigrationModel(Q4,Q4dist,0.05,0.7);
		MigrationModel createTreeModel = new ComplexConstantSeasonalRateBasedMigrationModel(QC1);
		//MigrationModel likelihoodModel = new ConstantRateBasedMigrationModel(Q4dist);
		MigrationModel likelihoodModel = new ConstantRateBasedMigrationModel(Q2);

		Tree myTree = new Tree(createTreeModel,8000);
		myTree.removeInternalStates();
		myTree.print();

		long time1 = System.currentTimeMillis();
		double ll_likelihoodmodel = myTree.logLikelihood(likelihoodModel);
		time1 = System.currentTimeMillis() - time1;

		myTree.clearCachedLikelihood();

		long time2 = System.currentTimeMillis();		
		double ll_creationmodel = myTree.logLikelihood(createTreeModel);
		time2 = System.currentTimeMillis() - time2;

		System.out.println("\n\nLog-Likelihood using Tree Create Model: "+ll_creationmodel+" time: "+time2+"ms");
		System.out.println("Log-Likelihood using Alternative Likelhood Model: "+ll_likelihoodmodel+" time: "+time1+"ms");


		// ..............................

		File treeFile = new File("h3n2.trees");
		FileReader reader = new FileReader(treeFile);

		NexusImporter nexusImporter = new NexusImporter(reader);		
		List<jebl.evolution.trees.Tree> nexsusTrees = nexusImporter.importTrees();

		myTree = new Tree((SimpleRootedTree) nexsusTrees.get(nexsusTrees.size()-5),14);
		//myTree.removeInternalStates();		
		// TODO: load traits from file...
		myTree.print();

		MigrationModel constatnStateModel14 = new ConstantRateBasedMigrationModel(Q14);

		time1 = System.currentTimeMillis();
		double ll_Q14 = myTree.logLikelihood(constatnStateModel14);
		time1 = System.currentTimeMillis() - time1;
		System.out.println("\n\nLog-Likelihood using State Model: "+ll_Q14+" time: "+time1+"ms");

		// ..............................

		treeFile = new File("beastInput.trees");
		reader = new FileReader(treeFile);

		nexusImporter = new NexusImporter(reader);		
		nexsusTrees = nexusImporter.importTrees();
		
		HashMap<String,Integer> traitMap = readTraits("traits.txt");
		
		MigrationModel constatnStateModel3 = new ConstantRateBasedMigrationModel(Q3S);
		
		System.out.println(nexsusTrees.get(0).getTaxa().iterator().next().getName());
		myTree = new Tree((SimpleRootedTree) nexsusTrees.get(nexsusTrees.size()-1),traitMap,3);
		//myTree.removeInternalStates();		
		myTree.print();

		time1 = System.currentTimeMillis();
		double ll_Q3 = myTree.logLikelihood(constatnStateModel3);
		time1 = System.currentTimeMillis() - time1;
		System.out.println("\n\nLog-Likelihood using State Model: "+ll_Q3+" time: "+time1+"ms");


	}
	
	static HashMap<String, Integer> readTraits(String fileName) throws NumberFormatException, IOException {

		FileInputStream traitFIStream = new FileInputStream(fileName);
		DataInputStream traitDIStream = new DataInputStream(traitFIStream);
		BufferedReader traitReader = new BufferedReader(new InputStreamReader(traitDIStream));
		
		HashMap<String,Integer> traitMap = new HashMap<String,Integer>();

		String strLine;
		//Read File Line By Line
		while ((strLine = traitReader.readLine()) != null)   {
			// Print the content on the console
			//System.out.println (strLine);
			String taxa = strLine;
			Integer state = Integer.parseInt(traitReader.readLine());
			traitMap.put(taxa, state);
		}
		
		return traitMap;
	}

}


